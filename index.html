<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Arkanoid game</title>

    <style>
        body {
            text-align: center;
            background: #333333;
        }

        canvas#game {
            background: rgba(70, 90, 140, 1);
            border: 1px #666666 solid;
        }
    </style>
    <!-- <script src="app.js"></script> -->
    <script type="module">
        import { Sprite } from './image.js';
        import { Ball } from './ball.js';

        window.onload = async function () {
            var canvas = document.getElementById('game');
            if (!canvas.getContext) {
                alert('Canvas unsupported, bye!');

                return;
            }

            var ctx = canvas.getContext('2d');

            console.debug('Loading images...');

            var ballImage = new Sprite('/img/ball.png');
            var paddle = new Sprite('/img/paddle.png');
            
            // Wait to load all images
            await Promise.all([
                ballImage.load(),
                paddle.load()
            ]).then((a) => {
                console.log(a);
            });

            var ball = new Ball(ballImage);
            
            // window.requestAnimationFrame(draw);

            let board_x = canvas.width;
            let board_y = canvas.height;

            setInterval(function () {

                ctx.clearRect(0, 0, canvas.width, canvas.height); // clear canvas
                // ctx.fillStyle = 'rgba(70, 90, 140, 1)';
                // ctx.strokeStyle = 'rgba(0, 153, 255, 0.4)';
                // ctx.strokeStyle = 'rgba(0, 153, 255, 0.4)';

                ball.loop();

                ball.draw(ctx);

                paddle.draw(ctx, 104 / 2, 800 - 24)
                // ctx.drawImage(ball, ball_posx, ball_posy);
                // ctx.drawImage(paddle, );

            }, 1000 / 30)
        };
    </script>
</head>

<body>
    <canvas id="game" width="600" height="800">

    </canvas>
</body>

</html>